\documentclass[12pt,letter]{article}

%% \usepackage[fleqn]{amsmath}
\usepackage[margin=1in]{geometry}
\usepackage{amsmath,amsfonts,amsthm,bm}
\usepackage{breqn}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{tikz}
\usepackage{algorithm2e}
\usepackage{siunitx}
\usepackage{graphicx}
\usepackage{subcaption}
%% \usepackage{datetime}
\usepackage{multirow}
\usepackage{multicol}
\usepackage{mathrsfs}
\usepackage{fancyhdr}
\usepackage{fancyvrb}
\usepackage{parskip} %turns off paragraph indent
\usepackage{float}
\usepackage{empheq}

\pagestyle{fancy}

\usetikzlibrary{arrows}

\DeclareMathOperator*{\argmin}{argmin}
\newcommand*{\argminl}{\argmin\limits}

\newcommand{\mathleft}{\@fleqntrue\@mathmargin0pt}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\ppartial}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\norm}[1]{\|#1\|}
\newcommand{\set}[1]{\{#1\}}
\newcommand{\notimplies}{\;\not\!\!\!\implies}

\setcounter{MaxMatrixCols}{20}

\begin {document}

  % \begin{cases}
  %     0, & \text{if}\ a=1 \\
  %     1, & \text{otherwise}
  %   \end{cases}

\lhead{Convex Optimization - HW3}
\rhead{(Bill) Yuan Liu, 996954078, 2020/02/29}

\begin{enumerate}
\item Q 5.12 textbook\\
  Derive dual problem for: $min_x - \sum_i log(b_i-a_i^Tx), x: a_i^Tx \leq b_i, \forall i \in \{1,..,m\}$
  \begin{align*}
    &y_i = b_i-a_i^Tx\\
    &a_i^Tx \leq b_i\\
    &L(x,y,\lambda,v)=-\sum_i log y_i + \sum_i \lambda_i(a_i^Tx-b_i) + \sum_i v_i(y_i+a_i^Tx-b_i)\\
    &g(\lambda,v)=\inf_{x,y} L(x,y,\lambda,v)\\
    &g(\lambda,v)=\inf_{x,y}-\sum_i log y_i + \sum_i \lambda_i(a_i^Tx-b_i) + \sum_i v_i(y_i+a_i^Tx-b_i)\\
    &(\exists i)\lambda_i \neq 0 \implies \lambda_i(a_i^Tx-b_i)\ unbounded,\ so\ \lambda = 0\\
    &g(\lambda,v)=\inf_{x,y}-\sum_i log y_i + \sum_i v_i(y_i+a_i^Tx-b_i)\\
    &g(\lambda,v)=\inf_{x,y}-\sum_i log y_i + v^Ty + v^TAx - v^Tb\\
    &(\exists i)v_i < 0 \implies v^Ty\ unbounded,\ so\ v \succeq 0\\
    &\frac{\partial}{\partial y_i}-\sum_i log y_i + v^Ty + v^TAx - v^Tb=-\frac{1}{y_i} + v_i=0\\
    &y_i = \frac{1}{v_i}, v_i \neq 0\\
    &(\forall i) v_i \neq 0 \wedge v_i \geq 0 \implies v \succ 0\\
    &\frac{\partial}{\partial x}-\sum_i log y_i + v^Ty + v^TAx - v^Tb=A^Tv=0\\
    &g(\lambda,v)=
      \begin{cases}
        -\sum_i log \frac{1}{v_i} + \sum_i \frac{v_i}{v_i} - v^Tb, & \text{if } A^Tv=0 \wedge v \succ 0\\
        -\infty, & \text{otherwise}
      \end{cases}
  \end{align*}
  Dual problem:
  \begin{align*}
    \max_{\lambda,v} &\sum_i log v_i + m - v^Tb = -(\min_{\lambda,v}-\sum_i log v_i - m + v^Tb)\\
    s.t.\ &A^Tv = 0\\
    &-v_i \leq 0, \forall i\\
  \end{align*}
  \pagebreak
\item Q 5.27 Equality constrained least squares\\
  Give KKT conditions, derive expressions for primal and dual solutions.
  \begin{align*}
    \min_x & \norm{Ax-b}_2^2\\
    s.t.\ & Gx=h            
  \end{align*}
  \begin{align*}
    &f_0 = x^TA^TAx + 2b^TAx + b^Tb\\
    &h_0 = Gx-h\\
    &L(x,\lambda,v) = f_0 + v^Th_0\\
    &L(x,\lambda,v) = x^TA^TAx - 2b^TAx + b^Tb + v^T(Gx-h)\\
    &\frac{\partial L}{\partial x^*} = 0 = 2A^TAx^* - 2A^Tb + G^Tv\\
    \\
    &KKT\ conditions:\\
    &x^* = \frac{1}{2}(A^TA)^{-1}(2A^Tb - G^Tv)\\
    &Gx^*-h = 0\\
    \\
    &g(\lambda,v)= \min_x L(x,\lambda,v) = \frac{1}{4}(2A^Tb-G^Tv)^T(A^TA)^{-1}(2A^Tb-G^Tv)\\
    &-2b^TA(\frac{1}{2}(A^TA)^{-1}(2A^Tb-G^Tv)) + b^Tb + v^T(G\frac{1}{2}(A^TA)^{-1}(2A^Tb-G^Tv)-h)\\
    &g(\lambda,v)= \min_x L(x,\lambda,v) = \frac{1}{4}(2A^Tb)^T(A^TA)^{-1}(2A^Tb)-(A^Tb)^T(A^TA)^{-1}(G^Tv)\\
    &+\frac{1}{4}(G^Tv)^T(A^TA)^{-1}(G^Tv) +b^TA((A^TA)^{-1}G^Tv)) -h^Tv + v^TG\frac{1}{2}(A^TA)^{-1}(2A^Tb-G^Tv) \\
    &- b^TA(A^TA)^{-1}2A^Tb) + b^Tb\\
    &\text{rid of constants and simplify}:\\
    &g(\lambda,v)= \min_x L(x,\lambda,v) = -\frac{1}{4}(G^Tv-2A^Tb)^T(A^TA)^{-1}(G^Tv-2A^Tb) \\
    &-\frac{1}{2}(Gv^T)^T(A^TA)^{-1}(G^Tv) -h^Tv\\
  \end{align*}
  Dual problem:
  \begin{align*}
    \max_{\lambda,v} & g(\lambda,v) = \max_v -\frac{1}{4}(G^Tv-2A^Tb)^T(A^TA)^{-1}(G^Tv-2A^Tb) \\
    &-\frac{1}{2}(Gv^T)^T(A^TA)^{-1}(G^Tv) -h^Tv\\
    s,t.\ & Gx^*-h=0
  \end{align*}
  Solve for $v^*$:\\
  \begin{align*}
    &Gx^*-h=0\\
    &x^* = \frac{1}{2}(A^TA)^{-1}(2A^Tb - G^Tv^*)\\
    &G\frac{1}{2}(A^TA)^{-1}(2A^Tb - G^Tv^*)-h=0\\
    &v^*=2G^{-T}(A^Tb-A^TAG^{-1}h)\\
  \end{align*}
  \pagebreak
\item Q 5.35 Sensitivity analysis of GP\\
  \pagebreak
\item Q 5.42 \\
  \pagebreak
\item Strong Duality for LP:\\
  Primal:
  \begin{align*}
    \min_x\ & c^Tx\\
    s.t.\ & Ax \geq b\\
           & x \geq 0
  \end{align*}
  Find the dual of the primal and argue that
  \begin{itemize}
  \item a) if the primal is unbounded then the dual is infeasible
    \begin{align*}
      L(x,\lambda,v) &= c^Tx + \lambda_1^T(b-Ax) + \lambda_2^T(-x)\\
      L(x,\lambda,v) &= (c^T-\lambda_1^TA -\lambda_2^T)x + \lambda_1^Tb\\
      g(\lambda,v) &= \min_x L(x,\lambda,v) =
      \begin{cases}
        b^T\lambda_1, & c -A^T\lambda_1-\lambda_2 = 0\\
        -\infty, & o/w
      \end{cases}\\
      Dual:\\
      \max_{\lambda_1,\lambda_2}\ & b^T\lambda_1\\
      s.t.\ & c - A^T\lambda_1 - \lambda_2 = 0\\
      \\
      g(\lambda,v) &\leq c^Tx^*\ (weak\ duality)\\
      primal\ & unbounded:\ c^Tx^*= -\infty \implies\\
      g(\lambda,v) &= -\infty \implies c -A^T\lambda_1-\lambda_2 \neq 0 \implies infeasible\ case\ of\ dual
    \end{align*}
  \item b) if the primal is infeasible then the dual is either infeasible or unbounded
    \begin{align*}
      &primal\ infeasible \implies b-Ax \not\leq 0 \vee -x \not\leq 0\\
      &\min_x c^Tx +\lambda_1^T(b-Ax) + \lambda_2^T(-x) \leq c^Tx\\
      % &(\forall i) (b-Ax)_i > 0 \implies \lambda_{1_i}\ may\ be\ nagative\\
      % &(\forall i) (-x)_i > 0 \implies \lambda_{2_i}\ may\ be\ nagative\\
      \\
      &dual\ unbounded\ case:\\
      &suppose\ c - A^T\lambda_1 - \lambda_2 = 0,\ substitute\ for\ \lambda_1:\\
      &Dual: \max_{\lambda_1,\lambda_2}\ b^T\lambda_1 = \max_{\lambda_1,\lambda_2} b^TA^{-T}c-b^TA^{-T}\lambda_2,\ such\ that:\\
      &(\forall i) (b-Ax)_i > 0 \implies \lambda_{1_i}\ may\ be\ nagative,\ and\\
      &(\forall i) (-x)_i > 0 \implies \lambda_{2_i}\ may\ be\ nagative,\ and\\
      &c - A^T\lambda_1 - \lambda_2 = 0\\
      \\
      &let\ d = b^TA^{-T}c\\
      &let\ e^T = b^TA^{-T}\\
      &Dual: \max_{\lambda_1,\lambda_2}\ d-e^T\lambda_2\\
      &(\exists i) e_i > 0: select\ \lambda_{2_i} \to -a \ and\ (\exists i) e_i < 0: select\ \lambda_{2_i} \to a, a \to +\infty \ such\ that\ it\ satisfies:\\
      &c - A^T\lambda_1 - \lambda_2 = 0,\ then\ e^T\lambda_2\ is\ unbounded\\
      &eg: c=\begin{bmatrix}0\\0\end{bmatrix}, b=\begin{bmatrix}1\\-1\end{bmatrix},A=I, Ax \not\succeq b, x \not\succeq 0\\
      &Dual:\ \max_{\lambda_1,\lambda_2}\ d- I^T\begin{bmatrix}1\\-1\end{bmatrix}^T\lambda_2,\ select\ \lambda_2 =\begin{bmatrix}-a\\a\end{bmatrix}\\
      &c-A^T\lambda_1-\lambda_2 =0=\begin{bmatrix}0\\0\end{bmatrix} - \lambda_1 - \begin{bmatrix}-a\\a\end{bmatrix} = 0\\
      &select:\ \lambda_1 =\begin{bmatrix}a\\-a\end{bmatrix}\\
      &let\ a \to +\infty \implies \max_{\lambda_1,\lambda_2}\ d - I^T\begin{bmatrix}1\\-1\end{bmatrix}^T\lambda_2\bigg|_{\lambda_2=[-a,a]^T} = d + 2a = +\infty \implies dual\ unbounded\\
      \\
      &dual\ infeasible\ case:\\
      &suppose: c > 0, x \not\geq 0, A=-1, Ax \geq b\\
      &Ax \geq b \implies \lambda_1 \geq 0\\
      &x < 0 \implies \lambda_2 \leq 0\\
      &c-A^T\lambda_1-\lambda_2 = c+\lambda_1 - \lambda_2\\
      &c+\lambda_1>0 \wedge -\lambda_2 \geq 0 \implies c-A^T\lambda_1-\lambda_2 \not=0 \implies dual\ is\ not\ feasible
    \end{align*}
  \end{itemize}
\item Game Theory
  \begin{align*}
    &\min_x \max_y x^TPy\\
    s.t.\ &Ax \leq b\\
    &Cy \leq d
  \end{align*}
  \begin{align*}
      &\max_y \min_x x^TPy\\
      s.t.\ &Ax \leq b\\
      &Cy \leq d
    \end{align*}
  \begin{itemize}
  \item show that min-max problem as the same optimal value as the following minimization problem:
    \begin{align*}
      &\min_{\lambda,x} d^T \lambda\\
      s.t.\ & C^T \lambda = P^Tx\\
      &Ax \leq b\\
      &\lambda \geq 0
    \end{align*}
    Inner optimization problem:
    \begin{align*}
      \max_y & (P^Tx)^T y = -(\min_y -(P^Tx)^T y)\\
      s.t.\ &Ax \leq b\\
             &Cy \leq d\\
      g(\lambda_1,\lambda_2) & = \min_y -(P^Tx)^T y =
                           \begin{cases}
                             \lambda_1^T(Ax-b)-\lambda_2^Td, & -P^Tx+C^T\lambda_2 = 0\\
                             -\infty, & o/w
                           \end{cases}\\
      \max_{\lambda_1,\lambda_2}\ & g(\lambda_1,\lambda_2) = \max_{\lambda_1,\lambda_2} -\lambda_2^Td + \lambda_1^T(Ax-b)\\
      s.t.\ & -P^Tx+C^T\lambda_2 = 0\\
             &\lambda_1, \lambda_2 \geq 0\\
             & \lambda_1^T(Ax-b) \leq 0 \implies\\
      \max_{\lambda_1,\lambda_2}\ & g(\lambda_1,\lambda_2) = \max_{\lambda_2} -\lambda_2^Td\\
      -(\min_y & -(P^Tx)^T y) = - \max_{\lambda_1,\lambda_2} g(\lambda_1,\lambda_2) = -(-\min_{\lambda_2} \lambda_2^Td) = \min_{\lambda_2} \lambda_2^Td\\
             rename\ &\lambda_2\ to\ \lambda\ and\ enclose\ with\ outer\ minimization:\\
      \min_{x,\lambda}&\ \lambda^Td\\
      s.t.\ &P^Tx = C^T\lambda\\
             &Ax \leq b\\
             &\lambda \geq 0
    \end{align*}
    \pagebreak
  \item show that max-min problem as the same optimal value as the following maximization problem:
    \begin{align*}
      &\max_{y,v} -b^T v\\
      s.t.\ & A^Tv + Py = 0\\
      &Cy \leq d\\
      &v \geq 0
    \end{align*}
    Inner optimization problem:
    \begin{align*}
      \min_x &\ x^TPy\\
      s.t.\ &Ax \leq b\\
             &Cy \leq d
      \\
      g(\lambda_1,\lambda_2) & = \min_x x^TPy + \lambda_1^T(Ax-b) + \lambda_2^T(Cy-d)\\
      & =
        \begin{cases}
          -\lambda_1^Tb + \lambda_2^T(Cy-d), & P^y + A^T\lambda_1 = 0\\
          - \infty, & o/w
        \end{cases}\\
      max_{\lambda_1,\lambda_2} g(\lambda_1,\lambda_2) & = \max_{\lambda_1,\lambda_2} -\lambda_1^Tb + \lambda_2^T(Cy-d)\\
      s.t.\ & P^Ty + A^T\lambda_1 = 0\\
      &\lambda_1 \geq 0\\
      &\lambda_2 \geq 0\\
      &Ax-b \leq 0\\
      &Cy-d \leq 0\\
      &\lambda_2^T(Cy-d)  \leq 0 \implies\\
      \max_{\lambda_1,\lambda_2} & \ g(\lambda_1,\lambda_2) = \max_{\lambda_1,\lambda_2} -\lambda_1^Tb\\
      s.t.\ & P^Ty + A^T\lambda_1 = 0\\
      &\lambda_1 \geq 0\\
             &Cy-d \leq 0\\
             &rename\ variables\ and\ enclose\ with\ outer\ optimization:\\
      \max_{y,v} &-b^Tv\\
      s.t.\ &P^T y + A^Tv = 0\\
      Cy &\leq d\\
      v &\geq 0
    \end{align*}
  \item show the above problems have the same optimal value (min-max equals max-min)
    \begin{align*}
      \min_{x,\lambda}&\ d^T \lambda\\
      s.t.\ & C^T\lambda = P^x\\
                       &Ax \leq b\\
                       &\lambda \geq 0\\
      \\
      g(a_1,a_2,w) &= \min_{x,\lambda} d^T\lambda + a_1^T(Ax-b)+a_2^T(-\lambda) + w^T(C^T\lambda-P^Tx)\\
      s.t.\ &a_1 \geq 0\\
                       &a_2 \geq 0\\
      &Ax-b \leq 0\\
                       &-\lambda \leq 0\\
                       &C^T\lambda - P^Tx = 0\\
      &g(a_1,a_2,w) =
                     \begin{cases}
                       -a_1^Tb , & d-a_2+Cw=0 \wedge A^Ta_1-Pw=0\\
                       -\infty, & o/w
                     \end{cases}\\
      dual:&\\
      \max_{a_1,a_2,w} & g(a_1,a_2,w) = -b^Ta_1\\
      s.t.\ & d-a_2+Cw=0\\
                      &A^Ta_1-Pw=0\\
                      &a_2 \geq 0 \implies d+Cw \geq 0\\
                      &a_1 \geq 0\\
      \\
      let\ &v = a_1, y = -w\\
      \max_{v,y}&\ g(v,y) = -b^Tv\\
      s.t.\ &A^Tv+Py=0\\
                      &Cy \leq d\\
                      &v \geq 0\\
    \end{align*}
    We start with equivalent formulation of min-max and arrive at a equivalent formulation of max-min problem thus they obtain the same optimal value.
  \end{itemize}
  
\end{enumerate}


\end {document}
